<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Expense Dashboard</title>
  <link rel="stylesheet" href="tracker.css">

  <!-- Bootstrap 5.3 -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">

   
</head>
<body>

<div class="container-fluid">
  <div class="row">
    <!-- Sidebar -->
    <div id="sidebar" class="col-md-3 col-lg-2 sidebar d-flex flex-column align-items-center">
      <img id="profileImage" src="https://cdn-icons-png.flaticon.com/512/3135/3135715.png" alt="Profile">
      
      <!-- Profile Options -->
      <div id="profileOptions" class="profile-options">
        <button id="addImageBtn">Add Image</button>
        <button id="removeImageBtn">Remove Image</button>
      </div>
      
      <!-- Hidden file input -->
      <input type="file" id="imageUpload" accept="image/*" style="display:none;">

      <nav class="nav flex-column w-100 px-3">
        <a class="nav-link active" data-section="home" href="#"><i class="fa-solid fa-house"></i> Home</a>
        <a class="nav-link" data-section="expenses" href="#"><i class="fa-solid fa-coins"></i> Expenses</a>
        <a class="nav-link" data-section="teams" href="#"><i class="fa-solid fa-users"></i> Teams</a>
        <a class="nav-link" data-section="approvals" href="#"><i class="fa-solid fa-square-check"></i> Approvals</a>
        <a class="nav-link" data-section="reports" href="#"><i class="fa-solid fa-chart-bar"></i> Reports</a>
        <a class="nav-link" data-section="support" href="#"><i class="fa-solid fa-phone"></i> Support</a>
      </nav>
    </div>

    <!-- Main content -->
    <div class="col content">
      <div id="home" class="content-section active">
        <h2>Welcome to Your Expense Dashboard</h2>
        <p>Track expenses, manage teams, approve requests, and generate reports — all in one place!</p>
      </div>

      <div id="expenses" class="content-section">
        <h2>New Expense</h2>
        <div class="mb-3"><label>Amount</label><input type="number" id="amount" class="form-control"></div>
        <div class="mb-3"><label>Date</label><input type="date" id="date" class="form-control"></div>
        <div class="mb-3"><label>Category</label>
          <select id="category" class="form-control">
            <option value="">Select</option>
            <option>Travel</option>
            <option>Food</option>
            <option>Office Supplies</option>
            <option>Other</option>
          </select>
        </div>
        <div class="mb-3"><label>Assign to Team Member</label><select id="assignedTo" class="form-control"></select></div>
        <div class="mb-3"><label>Description</label><textarea id="description" class="form-control"></textarea></div>
        <button class="btn btn-success" onclick="submitExpense()">Submit Expense for Approval</button>
      </div>

      <div id="teams" class="content-section">
        <h2>Teams</h2>
        <div class="mb-3"><label>Add Team Member</label><input type="text" id="teamMember" class="form-control"></div>
        <button class="btn btn-primary" onclick="addTeamMember()">Add Member</button>
        <h3>Team Members (<span id="memberCount">0</span>):</h3>
        <ul id="teamList"></ul>
      </div>

      <div id="approvals" class="content-section">
        <h2>Approvals</h2>
        <div id="approvalList"></div>
      </div>

      <div id="reports" class="content-section">
        <h2>Reports</h2>
        <button class="btn btn-warning" onclick="generateReport()">Generate Report</button>
        <div id="reportOutput"></div>
      </div>

      <div id="support" class="content-section">
        <h2>Support</h2>
        <div class="mb-3"><label>Your Name</label><input type="text" id="supportName" class="form-control"></div>
        <div class="mb-3"><label>Your Message</label><textarea id="supportMessage" class="form-control"></textarea></div>
        <button class="btn btn-info" onclick="sendSupport()">Send</button>
        <p id="supportResponse" class="mt-2 fw-bold"></p>
      </div>
    </div>
  </div>
</div>

<!-- Hamburger -->
<button class="btn btn-dark" id="menuToggle">
  <i class="fa-solid fa-xmark"></i>
</button>

<!-- Dark/Light Theme Toggle -->
<button class="theme-toggle" id="themeToggle">
  <i class="fa-solid fa-moon"></i>
</button>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // Sidebar toggle
  const menuToggle = document.getElementById('menuToggle');
  const sidebar = document.getElementById('sidebar');
  const menuIcon = menuToggle.querySelector("i");
  menuToggle.addEventListener('click', () => {
    sidebar.classList.toggle("collapsed");
    menuIcon.classList.toggle("fa-bars");
    menuIcon.classList.toggle("fa-xmark");
  });

  // Dark mode
  const themeToggle = document.getElementById('themeToggle');
  const body = document.body;
  themeToggle.addEventListener('click', () => {
    body.classList.toggle('dark-mode');
    const icon = themeToggle.querySelector("i");
    if (body.classList.contains("dark-mode")) {
      icon.classList.replace("fa-moon", "fa-sun");
      themeToggle.style.background = "#f39c12";
    } else {
      icon.classList.replace("fa-sun", "fa-moon");
      themeToggle.style.background = "#667eea";
    }
  });

  // Profile image menu
  const profileImage = document.getElementById("profileImage");
  const profileOptions = document.getElementById("profileOptions");
  const addImageBtn = document.getElementById("addImageBtn");
  const removeImageBtn = document.getElementById("removeImageBtn");
  const imageUpload = document.getElementById("imageUpload");

  profileImage.addEventListener("click", () => {
    profileOptions.style.display = profileOptions.style.display === "flex" ? "none" : "flex";
  });

  addImageBtn.addEventListener("click", () => {
    imageUpload.click();
    profileOptions.style.display = "none";
  });

  removeImageBtn.addEventListener("click", () => {
    profileImage.src = "https://cdn-icons-png.flaticon.com/512/3135/3135715.png";
    localStorage.removeItem("profileImage");
    profileOptions.style.display = "none";
  });

  imageUpload.addEventListener("change", () => {
    const file = imageUpload.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        profileImage.src = e.target.result;
        localStorage.setItem("profileImage", e.target.result);
      };
      reader.readAsDataURL(file);
    }
  });

  window.addEventListener("load", () => {
    const savedImage = localStorage.getItem("profileImage");
    if (savedImage) profileImage.src = savedImage;
  });

  // Navigation between sections
  const links = document.querySelectorAll('.nav-link');
  links.forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      links.forEach(l => l.classList.remove('active'));
      link.classList.add('active');
      document.querySelectorAll('.content-section').forEach(s => s.classList.remove('active'));
      document.getElementById(link.dataset.section).classList.add('active');
      if (link.dataset.section === "approvals") renderApprovals();
    });
  });

  // Data
  let pendingApproval = [];
  let approvalExpenses = [];
  let teamMembers = [];

  function saveData() {
    localStorage.setItem("teamMember", JSON.stringify(teamMembers));
    localStorage.setItem("pendingApproval", JSON.stringify(pendingApproval));
    localStorage.setItem("approvalExpenses", JSON.stringify(approvalExpenses));
  }
  function loadData() {
    teamMembers = JSON.parse(localStorage.getItem("teamMember")) || [];
    approvalExpenses = JSON.parse(localStorage.getItem("approvalExpenses")) || [];
    pendingApproval = JSON.parse(localStorage.getItem("pendingApproval")) || [];
    renderTeam();
    renderApprovals();
  }
  window.onload = () => { loadData(); };

  function submitExpense() {
    let amount = document.getElementById("amount").value;
    let date = document.getElementById("date").value;
    let assignedTo = document.getElementById("assignedTo").value;
    let category = document.getElementById("category").value;
    let description = document.getElementById("description").value;
    if (!amount || !date || !assignedTo || !category || !description) { alert("Please fill all fields"); return; }
    let expense = { amount: parseFloat(amount), date, assignedTo, category, description };
    pendingApproval.push(expense);
    saveData();
    alert("Expense submitted successfully");
    document.getElementById("amount").value = "";
    document.getElementById("date").value = "";
    document.getElementById("category").value = "";
    document.getElementById("description").value = "";
  }

  function addTeamMember() {
    let member = document.getElementById("teamMember").value;
    if (!member) { alert("Add member"); return; }
    teamMembers.push(member);
    document.getElementById("teamMember").value = "";
    saveData();
    renderTeam();
  }

  function renderTeam() {
    let teamList = document.getElementById("teamList");
    let assignedTo = document.getElementById("assignedTo");
    teamList.innerHTML = "";
    assignedTo.innerHTML = "<option value=''>Select</option>";
    teamMembers.forEach(member => {
      let li = document.createElement("li");
      li.textContent = member;
      teamList.appendChild(li);
      let opt = document.createElement("option");
      opt.value = member;
      opt.textContent = member;
      assignedTo.appendChild(opt);
    });
    document.getElementById("memberCount").textContent = teamMembers.length;
  }

  function renderApprovals() {
    let approvalList = document.getElementById("approvalList");
    approvalList.innerHTML = "";
    if (pendingApproval.length === 0) {
      approvalList.innerHTML = "<p>No pending approvals.</p>";
      return;
    }
    pendingApproval.forEach((exp, index) => {
      let div = document.createElement("div");
      div.className = "approval";
      div.innerHTML = `<span>${exp.date} - ${exp.category} - ₹${exp.amount} (${exp.assignedTo})</span>`;
      let approveBtn = document.createElement("button");
      approveBtn.textContent = "Approve";
      approveBtn.className = "btn btn-sm btn-success";
      approveBtn.onclick = () => approveExpense(index);
      let rejectBtn = document.createElement("button");
      rejectBtn.textContent = "Reject";
      rejectBtn.className = "btn btn-sm btn-danger";
      rejectBtn.onclick = () => rejectExpense(index);
      div.appendChild(approveBtn);
      div.appendChild(rejectBtn);
      approvalList.appendChild(div);
    });
  }

  function approveExpense(index) {
    approvalExpenses.push(pendingApproval[index]);
    pendingApproval.splice(index, 1);
    saveData();
    renderApprovals();
  }
  function rejectExpense(index) {
    pendingApproval.splice(index, 1);
    saveData();
    renderApprovals();
  }

  function generateReport() {
    let output = document.getElementById("reportOutput");
    if (approvalExpenses.length === 0) {
      output.innerHTML = "<p>No approved expenses yet.</p>";
      return;
    }
    let total = approvalExpenses.reduce((sum, e) => sum + e.amount, 0);
    let categories = {};
    approvalExpenses.forEach(e => { categories[e.category] = (categories[e.category] || 0) + e.amount; });
    let reportHtml = `<h4>Total Approved: ₹${total}</h4><ul>`;
    for (let cat in categories) { reportHtml += `<li>${cat}: ₹${categories[cat]}</li>`; }
    reportHtml += "</ul>";
    output.innerHTML = reportHtml;
  }

  function sendSupport() {
    let name = document.getElementById("supportName").value;
    let message = document.getElementById("supportMessage").value;
    if (!name || !message) { alert("Please fill in all fields"); return; }
    document.getElementById("supportResponse").textContent = "Thank you, " + name + "! Our team will respond shortly.";
    document.getElementById("supportName").value = "";
    document.getElementById("supportMessage").value = "";
  }
</script>
</body>
</html>
